<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>{{ session['email'] }} çš„æŸ¥éªŒæ¸…å…³è¿›åº¦è¡¨ - Wintime æ¸…å…³ç³»ç»Ÿ</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- DataTables -->
  <link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css" rel="stylesheet">
  <!-- Flatpickr æ—¥æœŸé€‰æ‹©å™¨ -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

  <style>
    body {
      padding: 20px;
      background-color: #f8f9fa;
    }
    .table-wrapper {
      overflow-x: auto;
    }
    th, td {
      vertical-align: middle !important;
      white-space: nowrap;
    }
    .header-title {
      font-weight: bold;
      font-size: 20px;
      color: #333;
    }
  </style>
</head>
<body>
<div class="container-fluid">
  <!-- é¡µçœ‰ + æ—¥æœŸé€‰æ‹© -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="header-title">ğŸ“Œ {{ session['email'] }} çš„æŸ¥éªŒæ¸…å…³è¿›åº¦è¡¨ï¼ˆWintime æ¸…å…³ç³»ç»Ÿï¼‰</div>
    <div class="d-flex gap-3">
      <input type="text" id="dateRange" class="form-control" placeholder="é€‰æ‹©ETAæ—¥æœŸèŒƒå›´">
      <!-- è¡¨å¤´é¢œè‰²é€‰æ‹©å™¨ -->
      <select id="themeSelector" class="form-select">
        <option value="table-primary">è“è‰²</option>
        <option value="table-secondary">ç°è‰²</option>
        <option value="table-success">ç»¿è‰²</option>
        <option value="table-warning">é»„è‰²</option>
        <option value="table-info">ç´«è‰²</option>
      </select>
    </div>
  </div>

  <!-- è¡¨æ ¼ + æ§ä»¶åŒº -->
  <div class="table-wrapper">
    <table id="dataTable" class="table table-bordered table-striped table-hover table-primary w-100">
      <thead class="align-middle">
        <tr>
          {% for header in headers %}
            <th>{{ header }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for row in tables %}
          <tr>
            {% for cell in row.values() %}
              <td>{{ cell }}</td>
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- JS è„šæœ¬ -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<script>
  $(document).ready(function () {
    // åˆå§‹åŒ– DataTable
    const table = $('#dataTable').DataTable({
      dom: '<"row mb-2"<"col-md-4"l><"col-md-4 text-center"B><"col-md-4"f>>rt<"row mt-2"<"col-md-6"i><"col-md-6"p>>',
      buttons: [
        {
          extend: 'excelHtml5',
          text: 'å¯¼å‡ºä¸º Excel'
        },
        {
          extend: 'pdfHtml5',
          text: 'å¯¼å‡ºä¸º PDF'
        },
        {
          extend: 'print',
          text: 'æ‰“å°é¡µé¢'
        }
      ],
      paging: true,
      pageLength: 10,
      lengthMenu: [10, 20, 30, 40],
      scrollX: true
    });

    // æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨
    flatpickr("#dateRange", {
      mode: "range",
      dateFormat: "Y-m-d"
    });

    // è¡¨å¤´é¢œè‰²åˆ‡æ¢
    $('#themeSelector').on('change', function () {
      const colorClass = $(this).val();
      $('#dataTable').removeClass().addClass(`table table-bordered table-striped table-hover ${colorClass} w-100`);
    });
  });
</script>
</body>
</html>
