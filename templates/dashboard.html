<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>OPFBA18@163.COM 的查验清关进度表（Wintime 清关系统）</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <style>
    body {
      padding: 20px;
      font-family: "Microsoft YaHei", sans-serif;
    }
    .table-responsive {
      overflow-x: auto;
    }
    th {
      background-color: #003366 !important;
      color: white !important;
      vertical-align: middle !important;
    }
    .logo-title {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    .logo-title img {
      height: 40px;
      margin-right: 10px;
    }
    .flatpickr-input {
      width: 280px;
    }
    .dt-buttons {
      float: right;
      margin-left: 20px;
    }
    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }
    .theme-select {
      width: 200px;
    }
  </style>
</head>
<body>
<div class="logo-title">
  <img src="/static/wintime_logo.png" alt="Wintime Logo">
  <h4 class="mb-0">OPFBA18@163.COM 的查验清关进度表（Wintime 清关系统）</h4>
</div>

<div class="toolbar">
  <div>
    <label for="dateRange">选择 ETA 日期范围：</label>
    <input id="dateRange" class="form-control d-inline-block flatpickr-input" placeholder="点击选择日期" readonly>
  </div>
  <div>
    <select id="colorTheme" class="form-select theme-select">
      <option value="table-primary">深蓝</option>
      <option value="table-secondary">深灰</option>
      <option value="table-dark">深紫</option>
      <option value="table-success">深绿</option>
      <option value="table-warning">深黄</option>
    </select>
  </div>
</div>

<div class="table-responsive">
  <table id="dataTable" class="table table-bordered table-hover table-striped w-100">
    <thead class="align-middle">
      <tr>
        {% for header in headers %}
          <th>{{ header }}</th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% for row in tables %}
        <tr>
          {% for cell in row.values() %}
            <td>{{ cell }}</td>
          {% endfor %}
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pdfmake@0.2.7/build/pdfmake.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pdfmake@0.2.7/build/vfs_fonts.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<script>
  flatpickr("#dateRange", {
    mode: "range",
    dateFormat: "Y-m-d",
    locale: "zh"
  });

  $(document).ready(function () {
    const table = $('#dataTable').DataTable({
      dom: 'lBfrtip',
      buttons: ['excel', 'pdf', 'print'],
      pageLength: 10,
      lengthMenu: [[10, 20, 30, 40], [10, 20, 30, 40]],
      responsive: true,
      scrollX: true
    });

    $('#colorTheme').on('change', function () {
      const theme = $(this).val();
      $('#dataTable').removeClass().addClass(`table table-bordered table-hover table-striped ${theme}`);
    });
  });
</script>
</body>
</html>
