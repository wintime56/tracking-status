<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>{{ session['email'] }} 的查验清关进度表 - Wintime 清关系统</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- DataTables -->
  <link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css" rel="stylesheet">
  <!-- Flatpickr 日期选择器 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

  <style>
    body {
      padding: 20px;
      background-color: #f8f9fa;
    }
    .table-wrapper {
      overflow-x: auto;
    }
    th, td {
      vertical-align: middle !important;
      white-space: nowrap;
    }
    .header-title {
      font-weight: bold;
      font-size: 20px;
      color: #333;
    }
  </style>
</head>
<body>
<div class="container-fluid">
  <!-- 页眉 + 日期选择 -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="header-title">📌 {{ session['email'] }} 的查验清关进度表（Wintime 清关系统）</div>
    <div class="d-flex gap-3">
      <input type="text" id="dateRange" class="form-control" placeholder="选择ETA日期范围">
      <!-- 表头颜色选择器 -->
      <select id="themeSelector" class="form-select">
        <option value="table-primary">蓝色</option>
        <option value="table-secondary">灰色</option>
        <option value="table-success">绿色</option>
        <option value="table-warning">黄色</option>
        <option value="table-info">紫色</option>
      </select>
    </div>
  </div>

  <!-- 表格 + 控件区 -->
  <div class="table-wrapper">
    <table id="dataTable" class="table table-bordered table-striped table-hover table-primary w-100">
      <thead class="align-middle">
        <tr>
          {% for header in headers %}
            <th>{{ header }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for row in tables %}
          <tr>
            {% for cell in row.values() %}
              <td>{{ cell }}</td>
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- JS 脚本 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<script>
  $(document).ready(function () {
    // 初始化 DataTable
    const table = $('#dataTable').DataTable({
      dom: '<"row mb-2"<"col-md-4"l><"col-md-4 text-center"B><"col-md-4"f>>rt<"row mt-2"<"col-md-6"i><"col-md-6"p>>',
      buttons: [
        {
          extend: 'excelHtml5',
          text: '导出为 Excel'
        },
        {
          extend: 'pdfHtml5',
          text: '导出为 PDF'
        },
        {
          extend: 'print',
          text: '打印页面'
        }
      ],
      paging: true,
      pageLength: 10,
      lengthMenu: [10, 20, 30, 40],
      scrollX: true
    });

    // 日期范围选择器
    flatpickr("#dateRange", {
      mode: "range",
      dateFormat: "Y-m-d"
    });

    // 表头颜色切换
    $('#themeSelector').on('change', function () {
      const colorClass = $(this).val();
      $('#dataTable').removeClass().addClass(`table table-bordered table-striped table-hover ${colorClass} w-100`);
    });
  });
</script>
</body>
</html>
